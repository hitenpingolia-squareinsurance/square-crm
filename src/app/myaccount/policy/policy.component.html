<section class="inner_page_css">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="main_card_form">
          <div class="main_header">
            <div class="header_title">
              <div *ngIf="ActivePage == 'Default'" class="box-title">Policies</div>
            </div>
          </div>
          <div class="main_body main_card_height_scroll_withoutfooter">

            <div>
              <div class="d_flex flex_End dsr-fillters" style="float: unset !important;">
                <button class="btn btn-info1" role="tab" id="headingOne" data-toggle="collapse" data-parent="#accordion"
                  href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  <a role="button" class="fa fa-filter"><span>Filters</span><i
                      class="fa fa-angle-down pull-right"></i></a>
                </button>
              </div>
            </div>

            <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
              <div class="panel-body">
                <!-- filter  -->
                <app-bms-filter (postCreated)="SearchData($event)"></app-bms-filter>
              </div>
            </div>
 
      
            <div class="mydiv table-responsive mt_3">
              <!-- <hr>
              <div class="row">
                <div class="col-sm-2"><b>Total Po</b></div>
                <div class="col-sm-1"><i class="fa fa-inr"></i> {{ TotalPO }}</div>
                
                <div class="col-sm-2"><b>Total Posted</b></div>
                <div class="col-sm-1"><i class="fa fa-inr"></i> {{ TotalPosted }}</div>
  
                <div class="col-sm-2"><b>Total Paid</b></div>
                <div class="col-sm-1"><i class="fa fa-inr"></i> {{ TotalPaid }}</div>
  
  
                <div class="col-sm-2"><b>Total Un-Paid Amount</b></div>
                <div class="col-sm-1"><i class="fa fa-inr"></i> {{(TotalPosted - TotalPaid).toFixed(2)}} </div>
  
               
                   
              </div> -->
              <table class="table table-bordered table-hover" id="Table1">
                <thead>
                  <tr>
                    <th><b>Type</b></th>
                    <th><b>Motor</b></th>
                    <th><b>Health</b></th>
                    <th><b>Non-Motor</b></th>
                    <th><b>Life</b></th>
                    <th><b>Travel</b></th>
                    <th><b>Personal Accident</b></th>
                    <th><b>Grand Total</b></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><b>Total Policy</b></td>
                    <td>{{TotalMotorSrData}}</td>
                    <td>{{TotalHealthSrData}}</td>
                    <td>{{TotalNon_MotorSrData}}</td>
                    <td>{{TotalLifeSrData}}</td>
                    <td>{{TotalTravelSrData}}</td>
                    <td>{{TotalPaSrData}}</td>
                    <td>{{TotalSR}}</td>
                  </tr>
                  <tr>
                    <td><b>Total Premium</b></td>
                    <td>{{TotalMotorNetPremium}}</td>
                    <td>{{TotalHealthNetPremium}}</td>
                    <td>{{TotalNon_MotorNetPremium}}</td>
                    <td>{{TotalLifeNetPremium}}</td>
                    <td>{{TotalTravelNetPremium}}</td>
                    <td>{{TotalPaNetPremium}}</td>
                    <td>{{TotalNetPremium}}</td>
                  </tr>
                  <!-- <tr *ngIf="(this.Login_Type == 'employee')">
                    <td><b>Total Gems</b></td>
                    <td>{{TotalMotorGems}}</td>
                    <td>{{TotalHealthGems}}</td>
                    <td>{{TotalNon_MotorGems}}</td>
                    <td>{{TotalLifeGems}}</td>
                    <td>{{TotalTravelGems}}</td>
                    <td>{{TotalPaGems}}</td>
                    <td>
                      <b> Total => </b> {{TotalGems}} <br>
                      <b> Paid => </b> {{TotalGemsPaid}} <br>
                      <b> Unpaid => </b> {{(TotalGems - TotalGemsPaid).toFixed(2)}}
                    </td>
                  </tr> -->

                 


                  <!-- <tr >
                    <td><b>Total PO</b></td>
                    <td>{{TotalMotorPO}}</td>
                    <td>{{TotalHealthPO}}</td>
                    <td>{{TotalNon_MotorPO}}</td>
                    <td>{{TotalLifePO}}</td>
                    <td>{{TotalTravelPO}}</td>
                    <td>{{TotalPaPO}}</td>
                    <td>
                      <b> Total PO => </b> {{TotalPO}} <br>
                      <b> Total Posted => </b> {{TotalPosted}} <br>
                      <b> Total Paid => </b> {{TotalPaid}} <br>
                      <b> Total Un_Paid => </b> {{(TotalPosted - TotalPaid).toFixed(2)}}
                    </td>
                  </tr> -->

                  <!-- <tr >
                    <td><b>Total Payin</b></td>
                    <td>{{TotalMotorPayin}}</td>
                    <td>{{TotalHealthPayin}}</td>
                    <td>{{TotalNon_MotorPayin}}</td>
                    <td>{{TotalLifePayin}}</td>
                    <td>{{TotalTravelPayin}}</td>
                    <td>{{TotalPaPayin}}</td>
                    <td>
                      <b> Total => </b> {{TotalPayin}} <br>
                    </td> -->
                  <!-- </tr> -->
                </tbody>
              </table>
            </div>

            <div class="all-data" *ngIf="this.Login_Type != 'user' && Partner != 'emitra' ">
              <ul>
                <li>Total Po<span><i class="fa fa-inr"></i> {{ TotalPO }}</span></li>
                <li>Total Posted<span><i class="fa fa-inr"></i> {{ TotalPaid }}</span></li>
                <li>Total Paid<span><i class="fa fa-inr"></i> {{ TotalPaid }}</span></li>
                <li>Total Un-Paid Amount<span><i class="fa fa-inr"></i> {{(TotalPosted - TotalPaid).toFixed(2)}}</span></li>
              </ul>
            </div>
            <div class="mydiv table-responsive">

              <table datatable [dtOptions]="dtOptions" id="Table1" class="table table-bordered table-hover">
                <thead>
                  <tr>
                    <th>S.No</th>
                    <th>LOB / Type</th>
                    <th>Vehicle No</th>
                    <th>Customer Details</th>

                    <th>Insurer</th>
                    <th>Policy Number</th>
                    <!-- <th>Vehicle No</th> -->

                    <th *ngIf="this.api.GetUserType() == 'admin' || this.api.GetUserType() == 'employee'">Login User
                    </th>
                    <th *ngIf="this.api.GetUserType() == 'admin' || this.api.GetUserType() == 'employee'">RM</th>


                    <th *ngIf="this.api.GetUserType() == 'employee'"> Create Date</th>
                    <th *ngIf="this.api.GetUserType() == 'employee'">Booking Date</th>
                    <th *ngIf="this.api.GetUserType() != 'employee'">Risk Start Date</th>
                    <th *ngIf="this.api.GetUserType() != 'employee'">Risk End Date</th>
                    <th>Premium</th>

                  </tr>
                </thead>

                <tbody *ngIf="dataAr?.length != 0">

                  <tr *ngFor="let row of dataAr; let i=index;">

                    <td>{{row.SrNo}}</td>

                    <td>
                      <label class="label label-success">{{row.LOB}}</label>
                      &nbsp;
                      <label class="label label-warning">{{row.TypeName}}</label>

                      &nbsp;<label *ngIf="(row.Policy_Type =='2')" class="label label-danger">Referred</label>

                      <br>
                      <!-- <a *ngIf="row.SR_Status == 'Complete' && row.DownloadUrl !=''" style="color:white;" class="label label-info" data-toggle="modal"
                                      data-target="#referal_link_modal" (click)="SendMailId(row.SrID)" > <i class="fa fa-share"></i> Share </a> -->

                      <label *ngIf="(row.CustomerMobile !='' && row.SR_Status == 'Complete' && row.DownloadUrl !='')"
                        (click)="WhatsappSend(row.SrID,row.CustomerMobile)" class="label label-success"><i
                          class="fa fa-whatsapp"></i>
                      </label>

                      &nbsp;&nbsp;
                      <label *ngIf="row.SR_Status == 'Complete' && row.DownloadUrl !=''"
                        (click)="SendMailPoupup(row.SrID)" class="label label-info"><i class="fa fa-envelope-o"></i>
                      </label>

                      <br>
                      <label
                        *ngIf="(row.SR_Status == 'Complete' && (row.redod  > this.FetchCurrentDate || row.redtp > this.FetchCurrentDate) ) && row.LOB == 'Motor'"
                        (click)="RaiseClaimPoupup(row.SrID)" class="label label-success" data-toggle="modal"
                        data-target="#AddCatSubCat" data-backdrop="static" data-keyboard="false"> Raise Claim
                      </label>
                      <br>
                      <label
                        *ngIf="(row.SR_Status == 'Complete' && (row.redod  > this.FetchCurrentDate || row.redtp > this.FetchCurrentDate)   ) && row.LOB == 'Motor'"
                        [routerLink]="['/endosment/details-form/'+row.EncodedSrNo]" class="label label-success"> Raise
                        Endrosment
                      </label>
                      <!-- <br>
                                  <label
                                    *ngIf="(row.SR_Status == 'Complete' && (row.redod  > this.FetchCurrentDate || row.redtp > this.FetchCurrentDate))"
                                    [routerLink]="['/endosment/details-form/'+row.EncodedSrNo]" class="label label-danger"> Raise
                                    Cancellation
                                  </label> -->
                    </td>

                    <td>{{row.Vehicle_No}}</td>

                    <td> <b>Name - </b> {{row.CustomerName}}<br> <b>Mobile - </b> {{row.CustomerMobile}}</td>




                    <td>{{row.Company}}</td>
                    <td>{{row.PolicyNo}} <br>
                      <label *ngIf="(row.DownloadUrl !='')" (click)="ViewDocument(row.DownloadUrl)"
                        class="label label-info label-inline mr-2 text-dark"><i class="fa fa-download">
                          Download</i></label>

                      <!-- <label *ngIf="(row.DownloadUrl !='')" class="label label-info label-inline mr-2 text-dark"
                                    (click)="SendPolicyMail(row.DownloadUrl , row.CustomerName  )"
                                    style="background-color: black !important;margin-top:8px !important;display: inline-block;">Send
                                    Mail</label> -->

                      <br>
                      <label *ngIf="row.Login_Scope!==null && row.Login_Scope!=='' && Login_Type =='employee'"
                        class="label label-info label-inline mr-2 text-dark"
                        style="background-color: black !important;margin-top:8px !important;display: inline-block;">{{
                        row.Login_Scope }}</label>
                      <br>
                      <label *ngIf="row.Ed_status == '1'" (click)="ViewEndrosmentUsingSrNo(row.SR_No)"
                        class="label label-danger label-inline mr-2">Endorsed</label>
                      <br>
                      <label *ngIf="row.SR_Status == 'Complete'"
                        class="label label-success label-inline mr-2">Booked</label>
                      <label *ngIf="row.SR_Status == 'Pending' && row.Underwriter_Emp_Id =='0'"
                        class="label label-danger label-inline mr-2">UnBooked</label>
                        <label  (click)="Qc_Rejected(row.SrID)"  *ngIf="row.SR_Status == 'Pending' && row.Underwriter_Emp_Id !='0'"
                        class="label label-danger label-inline mr-2">UnBooked/QC-Rejected</label>

                      <!-- <label *ngIf="row.SR_Status == 'Pending' && row.Underwriter_Emp_Id !='0'"
                        class="label label-danger label-inline mr-2">UnBooked/QC-Rejected</label> -->
                        
                    </td>

                    <td *ngIf="this.api.GetUserType() == 'admin' || this.api.GetUserType() == 'employee'">
                      {{row.Agent_Name}}</td>

                    <td *ngIf="this.api.GetUserType() == 'admin' || this.api.GetUserType() == 'employee'">
                      {{row.RM_Name}}</td>


                    <td *ngIf="this.api.GetUserType() == 'employee'">{{row.IssuedDate}}</td>
                    <td *ngIf="this.api.GetUserType() == 'employee'">{{row.BookingDate}}</td>
                    <td *ngIf="this.api.GetUserType() != 'employee'">
                      <div class="PayoutTable" *ngIf="row.LOB == 'Motor'">
                        <span><b>OD -</b> {{row.rsdod | date: 'dd/MM/yyyy'}}</span>
                        <br>
                        <span><b>TP -</b> {{row.rsdtp | date: 'dd/MM/yyyy'}}</span>
                      </div>
                      <div class="PayoutTable" *ngIf="row.LOB != 'Motor'">
                        <span><b></b> {{row.rsdtp | date: 'dd/MM/yyyy'}}</span>
                      </div>
                    </td>
                    <td *ngIf="this.api.GetUserType() != 'employee'">
                      <div class="PayoutTable" *ngIf="row.LOB == 'Motor'">
                        <span><b>OD-</b> {{row.redod | date: 'dd/MM/yyyy'}}</span> <br>
                        <span><b>TP -</b> {{row.redtp | date: 'dd/MM/yyyy'}}</span>
                      </div>
                      <div class="PayoutTable" *ngIf="row.LOB != 'Motor'">
                        <span><b> </b> {{row.redtp | date: 'dd/MM/yyyy'}}</span>
                      </div>
                    </td>
                    <td> <b>Net - </b>{{row.NetPremium}}<br> <b>Gross - </b>{{row.GrossPremium}}<br>
                      <span
                        *ngIf="(this.api.GetUserType() == 'agent' || this.api.GetUserType() == 'sp') && row.gems !='0' && Partner != 'emitra' "><b>
                          Gems Pts.-
                        </b>
                        {{row.gems}}
                      </span>
                    </td>
                  </tr>
                </tbody>
                <tbody *ngIf="dataAr?.length == 0">
                  <tr>
                    <td colspan="8" align="center">No data Available !</td>
                  </tr>
                <tbody>
              </table>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<div id="AddCatSubCat" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-12">
          <div class="main_card_form">
            <div class="main_header">
              <div class="header_title">Claim Request Form </div>
            </div>
            <form class="form" (ngSubmit)="RaiseClaim()" [formGroup]="AddCatForm">
              <div class="main_body main_card_height_scroll">
                <div class="row">
                  <div class="col-md-12">
                    <div class="form_sub_title"><i class="fa fa-smile-o mr_5"></i> Basic Details</div>
                  </div>
                  <div class="col-md-12">
                    <div class="input_group">
                      <label for="CustomerName">Assistance Type
                        <span *ngIf="isSubmitted1 && formControls2.ClaimType.errors" class="ValidationError">
                          <span *ngIf="formControls2.ClaimType.errors.required">Claim Type is required</span>
                        </span>
                      </label>
                      <div class="position_relative">
                        <!-- <ng-multiselect-dropdown class="form-control" name="ClaimType" placeholder="Select Claim Type"
                          [data]="ClaimTypeData" formControlName="ClaimType" [settings]="dropdownSingleSettingsType">
                        </ng-multiselect-dropdown> -->
                        <select id="dropdown" name="ClaimType" class="form_control" formControlName="ClaimType"
                          autocomplete="off">
                          <option value="">--Please Select--</option>
                          <option value="Claim Intimation">Claim Intimation</option>
                          <option value="Spot Survey">Spot Survey</option>
                          <option value="Final Survey">Final Survey</option>
                          <option value="Work Approval">Work Approval</option>
                          <option value="Parts Assessment Issue">Parts Assessment Issue</option>
                          <option value="DO Pending">DO Pending</option>
                          <option value="Cashless Issue">Cashless Issue</option>
                          <option value="Cashless Garage List">Cashless Garage List</option>
                          <option value="Documents Pendency">Documents Pendency</option>
                          <option value="Current Claim Status">Current Claim Status</option>
                          <option value="Claim Amount Confirmation">Claim Amount Confirmation</option>
                          <option value="Re-open Process">Re-open Process</option>
                          <option value="Others">Others</option>
                        </select>
                      </div>
                    </div>
                  </div>
                 

                  <div class="col-md-12">
                    <div class="input_group">
                      <label for="CustomerName">Driver/Customer Name
                        <span *ngIf="isSubmitted1 && formControls2.DriverName.errors" class="ValidationError">
                          <span *ngIf="formControls2.DriverName.errors.required">Driver Name is required</span>
                        </span>
                      </label>
                      <div class="position_relative">
                        <input class="form_control icon_cs" type="text" formControlName="DriverName" name="DriverName"
                          id="DriverName" placeholder="Enter Driver Name">
                      </div>
                    </div>
                  </div>


                  <div class="col-md-12">
                    <div class="input_group">
                      <label for="CustomerName">Driver/Customer Mobile
                        <span *ngIf="isSubmitted1 && formControls2.Mobile.errors" class="ValidationError">
                          <span *ngIf="formControls2.Mobile.errors.required">Mobile is required</span>
                          <span *ngIf="formControls2.Mobile.errors.pattern">Not Valid</span>
                          <span *ngIf="formControls2.Mobile.errors.maxlength">Mobile Max Length(10)</span>
                          <span *ngIf="formControls2.Mobile.errors.minlength">Mobile Minlength (10)</span>
                        </span>
                      </label>
                      <div class="position_relative">
                        <input class="form_control icon_cs" type="text" maxlength="10" formControlName="Mobile"
                          name="Mobile" id="Mobile" placeholder="Enter Mobile" (input)="onPanCardInputChange($event)">


                      </div>
                    </div>
                  </div>


                </div>

              </div>
              <div class="main_footer">
                <button type="button" id="ClosePOUPUP" class="mr_5 btn-danger Save_click"
                  data-dismiss="modal">Close</button>
                <button type="submit" class="Save_click">Raise Claim </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>