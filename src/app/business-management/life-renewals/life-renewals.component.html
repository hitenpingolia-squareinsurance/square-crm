<section class="inner_page_css main_dashboard_css">
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<div class="main_card_form">
					<div class="main_header">
						<div class="header_title">
							<!-- title  -->
							<div *ngIf="ActivePage == 'Default'">Life Renewals</div>
						</div>
					</div>
					<div class="main_body main_card_height_scroll_withoutfooter">
						<div class="row">
							<section class="pt-5 pb-5">
								<div class="box-blog">
									<div class="row">
										<div class="col-md-6">
											<div class="col-md-12">
												<div class="uprenewal">
													<h2>Upcoming Renewals</h2>
												</div>
											</div>
											<div class="col-lg-4 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a
														(click)="ChangeStatus([{Id:'Today',Name:'Today'}])"
														href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i class="fa fa-eercast"></i>
														</div>
														<h4>{{MonthRenewal.Day1}}</h4>
														<p class="xs-font-size13 xs-line-height-22">Today's</p>
													</a> </div>
											</div>
											<div class="col-lg-4 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a
														(click)="ChangeStatus([{Id:'15_Days',Name:'15 Days'}])"
														href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i class="fa fa-sun-o"
																aria-hidden="true"></i> </div>
														<h4>{{MonthRenewal.Day15}}</h4>
														<p class="xs-font-size13 xs-line-height-22">Next 15 day's</p>
													</a> </div>
											</div>
											<div class="col-lg-4 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a
														(click)="ChangeStatus([{Id:'30_Days',Name:'30 Days'}])"
														href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i
																class="fa fa-object-ungroup"></i> </div>
														<h4>{{MonthRenewal.Day30}}</h4>
														<p class="xs-font-size13 xs-line-height-22">Next 30 day's</p>
														<!--<span>1 Cars</span> <span>1 Bikes</span>-->
													</a> </div>
											</div>

											<!-- end -->
										</div>
										<div class="col-md-4">

											<div class="col-md-12">
												<div class="uprenewal">
													<h2>Missed Renewals</h2>
												</div>
											</div>

											<div class="col-lg-6 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i class="fa fa-calendar"
																aria-hidden="true"></i> </div>
														<h4>{{MonthRenewal.ThisMonth}}</h4>
														<p class="xs-font-size13 xs-line-height-22">This Month</p>
													</a> </div>
											</div>

											<div class="col-lg-6 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i class="fa fa-th-list"
																aria-hidden="true"></i> </div>
														<h4>{{MonthRenewal.LastMonth}}</h4>
														<p class="xs-font-size13 xs-line-height-22">Last Month</p>
													</a> </div>
											</div>

											<!-- end -->
										</div>

										<div class="col-md-2">
											<div class="col-md-12">
												<div class="uprenewal">
													<h2>Lost Renewals</h2>
												</div>
											</div>

											<div class="col-lg-12 col-md-6 margin-30px-bottom xs-margin-20px-bottom">
												<div class="services-block-three"> <a href="javascript:void(0)">
														<div class="padding-15px-bottom"> <i class="fa fa-calendar"
																aria-hidden="true"></i> </div>
														<h4>{{MonthRenewal.LostThisMonthRenewal}}</h4>
														<p class="xs-font-size13 xs-line-height-22">This Month Lost</p>
													</a> </div>
											</div>
										</div>

									</div>
								</div>
							</section>
						</div>

						<hr>

						<div>
							<div class="d_flex flex_End dsr-fillters" style="float: unset !important;">
								<button class="btn btn-info1" role="tab" id="headingOne" data-toggle="collapse"
									data-parent="#accordion" href="#collapseOne" aria-expanded="true"
									aria-controls="collapseOne">
									<a role="button" class="fa fa-filter"><span>Filters</span><i
											class="fa fa-angle-down pull-right"></i></a>
								</button>
							</div>
						</div>

						<div id="collapseOne" class="panel-collapse collapse" role="tabpanel"
							aria-labelledby="headingOne">
							<div class="panel-body">
								<!-- filter  -->
								<form *ngIf="checkedList?.length==0" [formGroup]="SearchForm" (ngSubmit)="SearchBtn()">

									<div class="row">
										<div class="col-sm-3">
											<select (change)="GetEmployees()" formControlName="Vertical_Id"
												class="form-control">
												<option value="0">Select Vertical</option>
												<option *ngFor="let r of Vertical_Ar;" value="{{r.Id}}">{{r.Name}}
												</option>
											</select>
										</div>

										<div class="col-sm-3">
											<select (change)="GetSubBranches($event)" formControlName="Region_Id"
												class="form-control">
												<option value="0">Select Region</option>
												<option value="0">None</option>
												<option *ngFor="let r of Region_Ar;" value="{{r.id}}">{{r.text}}
												</option>
											</select>
										</div>

										<div class="col-sm-3">
											<select (change)="GetEmployees()" formControlName="Sub_Region_Id"
												class="form-control">
												<option value="0">Select Region-Branch</option>
												<option value="0">None</option>
												<option *ngFor="let r of Sub_Branch_Ar;" value="{{r.id}}">{{r.text}}
												</option>
											</select>
										</div>

										<div class="col-sm-3">
											<ng-multiselect-dropdown name="Emp_Id" class="form-control"
												[placeholder]="Employee_Placeholder" [data]="Emps_Ar"
												formControlName="Emp_Id" [settings]="dropdownSettings"
												(onSelect)="onItemSelect($event,'Employee')"
												(onDeSelect)="onItemDeSelect($event,'Employee')">
											</ng-multiselect-dropdown>
										</div>
									</div>

									<div class="row"  >
										<div class="col-sm-3">
											<ng-multiselect-dropdown name="Agent_Id" class="form-control"
												[placeholder]="Agents_Placeholder" [data]="Agents_Ar"
												formControlName="Agent_Id" [settings]="AgentdropdownSettings">
											</ng-multiselect-dropdown>
										</div>

										<div class="col-sm-3">
											<ng-multiselect-dropdown name="Company_Id" class="form-control"
												placeholder="Select Ins Company" [data]="Companies_Ar"
												formControlName="Company_Id" [settings]="dropdownSettings">
											</ng-multiselect-dropdown>
										</div>

										<div class="col-sm-3">
											<ng-multiselect-dropdown name="SR_Source_Type" class="form-control"
												placeholder="Select Source" [data]="SRSource_Ar"
												formControlName="SR_Source_Type" [settings]="LOB_dropdownSettings"
												(onSelect)="onItemSelect($event,'Source')"> </ng-multiselect-dropdown>
										</div>

										<div class="col-sm-3">
											<ng-multiselect-dropdown name="Renewal_Period" class="form-control"
												placeholder="Select Renewal Period" [data]="RenewalPeriod_Ar"
												[(ngModel)]="SelectedRenewalPeriod" formControlName="Renewal_Period"
												[settings]="dropdownSettingsSingle"
												(onSelect)="EnableDisableMonthFilter('Renewal Period')"
												(onDeSelect)="EnableDisableMonthFilter('Renewal Period')">
											</ng-multiselect-dropdown>
										</div>
									</div>


									<div class="row"  >
										<div class="col-sm-2">
											<ng-multiselect-dropdown name="Month_Name" class="form-control"
												placeholder="Select Month" [data]="Months_Ar"
												[(ngModel)]="SelectedCurrentMonth" formControlName="Month_Name"
												[settings]="dropdownSettingsSingle" [disabled]="DisableMonthField">
											</ng-multiselect-dropdown>
										</div>

										<!-- *ngIf="ShowDateFilter == 'Yes'" -->
										<div class="col-sm-3">
											<input type="text" placeholder="Select Date OR Date-Range"
												class="form-control" (click)="EnableDisableMonthFilter('Date')"
												formControlName="DateOrDateRange" bsDaterangepicker
												[bsConfig]="{dateInputFormat: 'DD-MM-YYYY',isAnimated: true }">
											<span *ngIf="isSubmitted && FC.DateOrDateRange.errors"
												class="form-text text-muted">
												<span *ngIf="FC.DateOrDateRange.errors.required"
													style="color:red;">Please
													Select Date OR Date-Range !</span>
											</span>
										</div>

										<div class="col-sm-3">
											<input type="text" formControlName="GlobalSearch"
												placeholder="Search SR No/Policy/Vehicle No." class="form-control">
										</div>

										<div class="col-sm-2">
											<ng-multiselect-dropdown class="form-control" placeholder="Select Status"
												[data]="Status_Ar" [(ngModel)]="SelectedCurrentStatus"
												formControlName="Status" [settings]="dropdownSettingsSingle"
												[disabled]="DisableStatusField">
											</ng-multiselect-dropdown>
										</div>

										<div class="col-lg-2">
											<!-- <input type="submit" class="btn btn-info" value="Search"> -->
											<button type="submit" class="btn btn-info" style="font-size: small;"
												value="Search">
												<i class="fa fa-search">
													Search</i></button>
											&nbsp;&nbsp;
											<button (click)="ClearSearch()" type="button" style="font-size: small;"
												class="btn btn-danger" value="Reset"> <i class="fa fa-close"> Reset</i>
											</button>
										</div>
									</div>

								</form>
							</div>
						</div>




						<hr>

						<a (click)="SetActiveTab(1)" [ngClass]="(ActiveTab == 1?'btn btn-primary':'btn btn-info')">
							Installments </a> &nbsp;&nbsp;
						<a (click)="SetActiveTab(2)" [ngClass]="(ActiveTab == 2?'btn btn-primary':'btn btn-info')">
							1st Year Renewal </a> &nbsp;&nbsp;
						<a (click)="SetActiveTab(3)" [ngClass]="(ActiveTab == 3?'btn btn-primary':'btn btn-info')">
							2nd Year Renewal </a> &nbsp;&nbsp;
						<a (click)="SetActiveTab(4)" [ngClass]="(ActiveTab == 4?'btn btn-primary':'btn btn-info')">
							3rd Year Renewal </a> &nbsp;&nbsp;
						<a (click)="SetActiveTab(5)" [ngClass]="(ActiveTab == 5?'btn btn-primary':'btn btn-info')">
							>3 Year Renewal </a> &nbsp;&nbsp;

						<hr>

						<table id="Table1" class="table table-bordered table-hover">
							<thead>
								<tr>
									<td><label>Label / Status</label></td>
									<td><label> Total </label></td>
									<td><label> Pending</label></td>
									<td><label> Renewed</label></td>
									<td><label> Lost</label></td>
								</tr>

								<tr>
									<td><label>No Of Cases</label></td>
									<td><span> {{TotalRes}}</span></td>
									<td><span> {{TotalPending}}</span></td>
									<td><span> {{TotalRenewed}}</span></td>
									<td><span> {{TotalLost}}</span></td>
								</tr>

								<tr>
									<td><label>Premium</label></td>
									<td><span> {{TotalPremium}}</span></td>
									<td><span> {{TotalPendingPremium}}</span></td>
									<td><span> {{TotalRenewedPremium}}</span></td>
									<td><span> {{TotalLostPremium}}</span></td>
								</tr>

								<!-- <tr>
				<td><label>Ratio</label></td>
				<td><span> {{TotalRes}}</span></td>
				<td><span> {{TotalRes}}</span></td>
				<td><span> {{TotalRes}}</span></td>
				<td><span> {{TotalRes}}</span></td>
			</tr> -->
							</thead>
						</table>

						<hr>
						<div class=" mydiv table-responsive">
							<table datatable [dtOptions]="dtOptions" id="example2"
								class="table table-bordered table-hover">
								<thead>
									<tr>

										<th>No</th>
										<th>Action / Details </th>
										<th>SR No / Proposer Type</th>
										<th>Policy Iss/Risk Start Date</th>
										<th>Renewal Date / Payment Frequency</th>
										<th>Net / Gross Premium</th>
										<th>Renewal Status / Lapsed Days</th>
										<th>Customer Name</th>
										<th style="text-align:center;">Policy No</th>
									</tr>
								</thead>

								<tbody *ngIf="dataAr?.length != 0">
									<tr *ngFor="let row of dataAr; let i=index;">
										<td>{{row.SrNo}}.</td>

										<td>
											<a href="javascript:;" *ngIf="row.Renewal_Status == 0"
												(click)="UpdateRenewalAction(row.Id, row.Track_Id)"><span
													style="margin-right: 5px;"
													class="label label-default">Action</span></a>

											<span>
												<a href="javascript:;" (click)="SrPopup(1,row.Id)"><span
														style="margin-right: 5px;"
														class="label label-info">Details</span></a>
											</span>

											<span>
												<a href="javascript:;" (click)="ViewRenewalTrack(row.Id)"><span
														style="margin-right: 5px;" class="label label-primary">Payment
														Track</span></a>
											</span>

											<span *ngIf="row.ChangePayFrequency == 'Yes'"><br>
												<a href="javascript:;"
													(click)="UpdatePaymentFrequency(row.Id, row.RenewalYear)"><span
														style="margin-right: 5px;" class="label label-primary">Change
														Pay. Frequency</span></a>
											</span>

										</td>

										<td><span *ngIf="row.LOB_Name=='LI'">LI</span>{{row.SR_No}}
											<span style="margin-right: 5px;" *ngIf="row.LI_Proposer_Type== 'Individual'"
												class="label label-primary">Individual</span>
											<span style="margin-right: 5px;" *ngIf="row.LI_Proposer_Type== 'Group'"
												class="label label-primary">Group</span>
										</td>

										<td>{{row.Policy_Issuance_Date}}</td>

										<td>{{row.Renewal_Date}}
											<span style="margin-right: 5px;"
												*ngIf="row.LI_Payment_Frequency== 'Monthly'"
												class="label label-primary">Monthly</span>
											<span style="margin-right: 5px;"
												*ngIf="row.LI_Payment_Frequency== 'Quarterly'"
												class="label label-warning">Quarterly</span>
											<span style="margin-right: 5px;"
												*ngIf="row.LI_Payment_Frequency== 'Half Yearly'"
												class="label label-success">Half Yearly</span>
											<span style="margin-right: 5px;" *ngIf="row.LI_Payment_Frequency== 'Yearly'"
												class="label label-danger">Yearly</span>
										</td>

										<td>
											<strong>Net :</strong>{{ row.Net_Premium}}<br>
											<strong>Gross :</strong>{{ row.Estimated_Gross_Premium}}
										</td>

										<td>
											<span style="margin-right: 5px;"
												*ngIf="row.Renewal_Status == 0 && ShowDateFilter == 'No'"
												class="label label-warning">Pending</span>
											<span style="margin-right: 5px;"
												*ngIf="row.Renewal_Status == 1 && ShowDateFilter == 'No'"
												class="label label-success">Complete</span>
											<span style="margin-right: 5px;background: black;"
												*ngIf="ShowDateFilter == 'Yes'" class="label label_new">{{
												row.Lapsed_Days }}</span>
										</td>

										<td>{{row.Customer_Name}}</td>
										<td><span>{{row.Policy_No}}</span></td>

									</tr>
								</tbody>

								<tbody *ngIf="dataAr?.length == 0">
									<tr>
										<td colspan="9" align="center">No data Available !</td>
									</tr>
								<tbody>
							</table>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>