<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">

    <!-- Main content -->
    <section class="content">

        <!-- SELECT2 EXAMPLE -->
        <div class="box box-default">
            <div class="box-body">

                <div class="box-header">
                    <h3 class="box-title">Business Report</h3>
                </div>


                <table>
                    <tr>
                        <th>Type</th>
                        <th>Booked</th>
                        <th>Un-Booked</th>
                        <th>Cancelled</th>
                        <th>Total</th>
                    </tr>
                    <tr>
                        <td>SR</td>

                        <td>{{TotalBookedSR}}</td>
                        <td>{{TotalUnBookedSR}}</td>
                        <td>{{TotalCancelledSR}}</td>
                        <td>{{TotalSR}}</td>
                    </tr>

                    <tr>
                        <td>Business</td>

                        <td>{{TotalBookedPremium}}</td>
                        <td>{{TotalUnBookedPremium}}</td>
                        <td>{{TotalCancelledNetPremium}}</td>
                        <td>{{TotalNetPremium}}</td>
                    </tr>

                    <tr>
                        <td>Revenue</td>

                        <td>{{TotalBookedRevenue}}</td>
                        <td>{{TotalUnBookedRevenue}}</td>
                        <td>{{TotalCancelledRevenue}}</td>
                        <td>{{TotalRevenue}}</td>
                    </tr>




                </table>

                <hr>


                <!--<form [formGroup]="SearchForm" (ngSubmit)="SearchBtn()">
          
          <div class="row">
                  <div class="col-sm-3">
                      <ng-select
                          
                            [items]="Emps_Ar"
                            formControlName="Emp_Id" 
                            
                            placeholder="Select Employee"></ng-select>
                            
                  </div>
                  <div class="col-sm-3">
                      <ng-select
                            [items]="Agents_Ar"
                            formControlName="Agent_Id"
                            (keyup)="searchAgents($event)"   
                            placeholder="Select Agent"></ng-select>
                  </div>
                  
                  
                  
                  
                  <div class="col-sm-3">
                      <ng-select
                            [items]="Departments_Ar"
                            formControlName="Department_Id"
                             
                            placeholder="Select Department"></ng-select>
                  </div>
                  
                   
                  
                  
                  <div class="col-sm-3">
                      <select (change)="GetSubBranches($event)"  formControlName="Region_Id" class="form-control">
                          <option value="">Select Region</option>
                          <option *ngFor="let r of Region_Ar;" value="{{r.id}}">{{r.text}}</option>
                      </select>
                  </div>
                  
                  
                   
                  
                  
                   
               
          
          </div>
          
          <div class="row"  >
          
              <div class="col-sm-3">
                      <select formControlName="Sub_Region_Id" class="form-control">
                          <option value="">Select Region-Branch</option>
                          <option *ngFor="let r of Sub_Branch_Ar;" value="{{r.id}}">{{r.text}}</option>
                           
                      </select>
                  </div>
                  
              
              <div class="col-sm-3">
                      <ng-select
                            [items]="Products_Ar"
                            formControlName="Product_Id"
                             
                            placeholder="Select Product"></ng-select>
                  </div>
                  
                  <div class="col-sm-3">
                      <ng-select
                            [items]="Companies_Ar"
                            formControlName="Company_Id"
                             
                            placeholder="Select Ins Company"></ng-select>
                  </div>
                  
                  <div class="col-sm-3">
                      <select formControlName="Source" class="form-control" placeholder="Select Source">
                          <option value="">Select Source</option>
                          <option value="Excel">Excel</option>
                          <option value="BMS">BMS</option>
                          <option value="Web">Web</option>
                      </select>
                  </div>
          </div>
           
          
          
          <div class="row"  >
          
          <div class="col-sm-3">
                  <select formControlName="LOB_Type" class="form-control" placeholder="Select LOB Type">
                  <option value="">Select LOB Type</option>
                      <option value="Motor">Motor</option>
                      <option value="Non Motor">Non Motor</option> 
                      <option value="Health">Health</option>
                  </select>
              </div>
          
          <div class="col-sm-3">
                  <select formControlName="SR_Status" class="form-control" placeholder="Select SR Status">
                  <option value="">Select SR Status</option>
                      <option value="Booked">Booked</option>
                      <option value="UnBooked">UnBooked</option> 
                      <option value="Cancelled">Cancelled</option>
                  </select>
              </div>
          
            <div class="col-sm-3">
                    <input
                    type="text"
                    placeholder="Select Date OR Date-Range"
                    class="form-control" 
                    formControlName="DateOrDateRange"
                    bsDaterangepicker
                    [bsConfig]="{dateInputFormat: 'DD-MM-YYYY',isAnimated: true }">
              </div>
              
               
              
              <div class="col-sm-3" style="text-align: right;">
                  <input (click)="ExportExcelDemo()" type="button" class="btn btn-success" value="Export">
                  &nbsp;&nbsp;
                  
                  
                  <input type="submit" class="btn btn-info" value="Search">
                  &nbsp;&nbsp;
                  <button (click)="ClearSearch()" type="button" style="font-size: small;" class="btn btn-danger" value="Reset"> <i
                      class="fa fa-close"> Reset</i> </button>
              </div>
              
          </div>
      
      </form>-->

                <form [formGroup]="SearchForm" (ngSubmit)="SearchBtn('0')">

                    <div class="row">

                        <div class="col-sm-4">



                            <select (change)="GetEmployees()" formControlName="Vertical_Id" class="form-control">
                                <option value="0">Select Vertical</option>

                                <option *ngFor="let r of Vertical_Ar;" value="{{r.Id}}">{{r.Name}}</option>
                            </select>

                        </div>

                        <div class="col-sm-4">
                            <select (change)="GetSubBranches($event)" formControlName="Region_Id" class="form-control">
                                <option value="0">Select Region</option>
                                <option value="0">None</option>
                                <option *ngFor="let r of Region_Ar;" value="{{r.id}}">{{r.text}}</option>
                            </select>
                        </div>

                        <div class="col-sm-4">
                            <select (change)="GetEmployees()" formControlName="Sub_Region_Id" class="form-control">
                                <option value="0">Select Region-Branch</option>
                                <option value="0">None</option>
                                <option *ngFor="let r of Sub_Branch_Ar;" value="{{r.id}}">{{r.text}}</option>
                            </select>
                        </div>


                    </div>

                    <div class="row"  >

                        <div class="col-sm-6">

                            <ng-multiselect-dropdown class="form-control" name="Emp_Id"
                                [placeholder]="Employee_Placeholder" [data]="Emps_Ar" formControlName="Emp_Id"
                                [settings]="dropdownSettings" (onSelect)="onItemSelect($event,'Employee')"
                                (onDeSelect)="onItemDeSelect($event,'Employee')">
                            </ng-multiselect-dropdown>


                        </div>
                        <div class="col-sm-6">

                            <ng-multiselect-dropdown class="form-control" name="Agent_Id"
                                [placeholder]="Agents_Placeholder" [data]="Agents_Ar" formControlName="Agent_Id"
                                [settings]="AgentdropdownSettings">
                            </ng-multiselect-dropdown>
                        </div>






                    </div>


                    <div class="row"  >

                        <div class="col-sm-2">

                            <ng-multiselect-dropdown class="form-control" name="SRLOB" placeholder="Select LOB"
                                [data]="SRLOB_Ar" formControlName="SRLOB" [settings]="LOB_dropdownSettings"
                                (onSelect)="onItemSelect($event,'LOB')" (onDeSelect)="onItemDeSelect($event,'LOB')">
                            </ng-multiselect-dropdown>

                        </div>

                        <div class="col-sm-4">

                            <ng-multiselect-dropdown class="form-control" name="Product_Id" placeholder="Select Product"
                                [data]="Products_Ar" formControlName="Product_Id" [settings]="dropdownSettings">
                            </ng-multiselect-dropdown>


                        </div>

                        <div class="col-sm-4">

                            <ng-multiselect-dropdown class="form-control" name="Company_Id"
                                placeholder="Select Ins Company" [data]="Companies_Ar" formControlName="Company_Id"
                                [settings]="dropdownSettings">
                            </ng-multiselect-dropdown>


                        </div>



                        <div class="col-sm-2">


                            <ng-multiselect-dropdown class="form-control" name="SRStatus" placeholder="Select SR Status"
                                [data]="SRStatus_Ar" formControlName="SRStatus" [settings]="SR_StatusDropdownSettings">
                            </ng-multiselect-dropdown>

                            <span *ngIf="isSubmitted && FC.SRStatus.errors" class="form-text text-muted">
                                <span *ngIf="FC.SRStatus.errors.required" style="color:red;">Please choose business
                                    type!</span>
                            </span>


                        </div>
                    </div>
                    <div class="row"  >


                        <div class="col-sm-2">

                            <ng-multiselect-dropdown class="form-control" name="SR_Type" placeholder="Select SR Type"
                                [data]="SRType_Ar" formControlName="SR_Type" [settings]="LOB_dropdownSettings"
                                (onSelect)="onItemSelect($event,'SR_Type')">
                            </ng-multiselect-dropdown>

                        </div>


                        <div class="col-sm-2">

                            <ng-multiselect-dropdown class="form-control" name="SR_Source_Type"
                                placeholder="Select Source" [data]="SRSource_Ar" formControlName="SR_Source_Type"
                                [settings]="LOB_dropdownSettings" (onSelect)="onItemSelect($event,'Source')">
                            </ng-multiselect-dropdown>

                        </div>


                        <div class="col-sm-2">

                            <ng-multiselect-dropdown class="form-control" name="SR_Payout_Mode"
                                placeholder="Payout-Mode" [data]="SR_Payout_Mode_Ar" formControlName="SR_Payout_Mode"
                                [settings]="LOB_dropdownSettings" (onSelect)="onItemSelect($event,'SR_Payout_Mode')">
                            </ng-multiselect-dropdown>

                        </div>


                        <div class="col-sm-3">

                            <ng-multiselect-dropdown class="form-control" name="SR_Posting_Status"
                                placeholder="Select Posting-Status" [data]="SR_Posting_Status_Ar"
                                formControlName="SR_Posting_Status" [settings]="LOB_dropdownSettings"
                                (onSelect)="onItemSelect($event,'SR_Posting_Status')">
                            </ng-multiselect-dropdown>

                        </div>

                        <div class="col-sm-3">
                            <input type="text" placeholder="Select Date OR Date-Range" class="form-control"
                                formControlName="DateOrDateRange" bsDaterangepicker
                                [bsConfig]="{dateInputFormat: 'DD-MM-YYYY',isAnimated: true }">

                            <span *ngIf="isSubmitted && FC.DateOrDateRange.errors" class="form-text text-muted">
                                <span *ngIf="FC.DateOrDateRange.errors.required" style="color:red;">Please choose Date
                                    or Date-Range!</span>
                            </span>

                        </div>


                    </div>

                    <div class="row"  >

                        <div class="col-sm-6"></div>

                        <div class="col-sm-6" style="text-align: right;">

                            <input *ngIf="(Is_Export==1 && UserRights.Is_Pivot_Report == 1)"
                                (click)="ExportPivotExcel()" type="button" class="btn btn-success" value="Export Pivot">
                            &nbsp;&nbsp;

                            <input *ngIf="(Is_Export==1)" (click)="ExportExcel()" type="button" class="btn btn-success"
                                value="Export">
                            &nbsp;&nbsp;
                            <input type="submit" class="btn btn-info" value="Search">
                            &nbsp;&nbsp;
                            <button (click)="ClearSearch()" type="button" style="font-size: small;"
                                class="btn btn-danger" value="Reset"> <i class="fa fa-close"> Reset</i> </button>
                        </div>

                    </div>

                </form>

                <hr>
                <div class="">
                    <form [formGroup]="SearchForm1">
                        <div class="row">
                            <div class="col-sm-9"></div>
                            <div class="col-sm-3 mb-3">
                                <div class="input-group" style="display: flex;width: 100%;">
                                    <input type="text" formControlName="GlobalSearch" placeholder="Search"
                                        class="form-control"
                                        [ngClass]="(isSubmitted1 && FC1.GlobalSearch.errors && FC1.GlobalSearch.errors.required?'form-control errorMsgg':'form-control')">
                                    <div class="input-group-append">
                                        <button class="btn btn-info" type="button" (click)="SearchBtn('1')"><span
                                                class="fa fa-search"></span></button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>


                <hr>


                <!--<table>
      <tr>
          <th colspan="2">Promise</th>
      </tr>
      <tr>
          <th>Id</th>
          <th>created_at</th>
      </tr>
      <tr *ngFor="let datas of obsevableResponseArray">
          <td>{{datas.id}}</td>
          <td>{{datas.created_at}}</td>
      </tr>
  </table>
  -->

                <!--begin: Datatable-->
                <div class="table-responsive mysrdiv" id="mydiv">
                    <table datatable [dtOptions]="dtOptions"
                        class="row-border hover table table-bordered table-hover table-checkable table-responsive"
                        id="kt_datatable" style="margin-top: 13px !important">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Action</th>
                                <th>Posting-Status</th>
                                <th>CreateDate</th>
                                <th>BookingDate/Status</th>
                                <th>Current/User Status</th>
                                <th>SRCreateUser</th>
                                <th>Remark</th>

                                <th>Source</th>
                                <th>S.No</th>

                                <th>LOB</th>
                                <th>PaymentTowards</th>
                                <th>PaymentMode</th>
                                <th>RegistrationNo</th>
                                <th>GrossPremium</th>
                                <th>File Type</th>
                                <th>Customer Name</th>
                                <th>Agent</th>
                                <th>RM</th>

                                <th>UW</th>
                                <th>OPS</th>
                                <th>Account</th>



                            </tr>
                        </thead>
                        <tbody *ngIf="dataAr?.length != 0">
                            <tr *ngFor="let row of dataAr; let i=index;">
                                <td>{{ row.SrNo }}.</td>


                                <td>
                                    <div class="d_flex flex_Start flex_column flex_wrap">
                                        <a title="SR-Actions" href="javascript:;" (click)="SrPopup(1,row.Id)">
                                            <span style="margin-bottom: 5px;"
                                                class="label label-info label-inline mr-2">Details</span>
                                        </a>
                                        <a *ngIf="api.GetUserData('User_Id_Dec') ==1" title="SR-Actions"
                                            href="javascript:;" (click)="Actions(row.Id)">
                                            <span style="margin-bottom: 5px;"
                                                class="label label-info label-inline mr-2">Details-Old</span>
                                        </a>
                                        <a *ngIf="( row.Status=='1') && (UserRights['Is_SR_Edit'] == '1') "
                                            title="SR-Edit" href="javascript:;" (click)="SrPopup(0,row.Id)">
                                            <span style="margin-bottom: 5px;width:80px;"
                                                class="label label-danger label-inline mr-2">Edit-SR</span>
                                        </a>
                                        <a href="javascript:;" (click)="EditPayout(row.Id,i)"
                                            *ngIf="(UserRights['Is_SR_Edit'] == '1')">
                                            <span style="margin-bottom: 5px; width:80px;"
                                                *ngIf="row.Payout_Custom_Update == '0'"
                                                class="label label-danger label-inline mr-2">Edit-PO</span>
                                            <span style="margin-bottom: 5px; width:80px;"
                                                *ngIf="row.Payout_Custom_Update == '1'"
                                                class="label label-warning label-inline mr-2">Re-Edit PO</span>
                                        </a>
                                        <a href="javascript:;" (click)="EditPremium(row.Id)">
                                            <span style="margin-bottom: 5px;width: 90px;"
                                                class="label label-info label-inline mr-2">Edit-Premium</span>
                                        </a>
                                        <a *ngIf="row.Status=='1'" title="SR-Actions" href="javascript:;"
                                            (click)="Cancel(row.Id)">
                                            <span class="label label-warning label-inline mr-2">Cancel</span>
                                        </a>
                                        <a *ngIf="row.Status=='0'" title="SR-Actions" href="javascript:;">
                                            <span class="label label-danger label-inline mr-2">Cancelled</span>
                                        </a>
                                    </div>
                                </td>


                                <td>

                                    <span *ngIf="row.Posting_Status == '0'"
                                        class="label label-warning label-inline mr-2">PendingForPosting</span>
                                    <span *ngIf="row.Posting_Status == '1'"
                                        class="label label-default label-inline mr-2">PendingForAccounts</span>
                                    <span *ngIf="row.Posting_Status == '2'"
                                        class="label label-danger label-inline mr-2">RejectByAccounts</span>
                                    <span *ngIf="row.Posting_Status == '3'"
                                        class="label label-primary label-inline mr-2">PendingForBanking</span>
                                    <span *ngIf="row.Posting_Status == '4'"
                                        class="label label-danger label-inline mr-2">RejectByBanking</span>
                                    <span *ngIf="row.Posting_Status == '5'"
                                        class="label label-info label-inline mr-2">Approved</span>
                                    <span *ngIf="row.Posting_Status == '6'"
                                        class="label label-success label-inline mr-2">Paid/PayoutTransfered</span>
                                    <span *ngIf="row.Posting_Status == '7'"
                                        class="label label-default label-inline mr-2">Direct-Customer</span>
                                    <span *ngIf="row.Posting_Status == '8'"
                                        class="label label-primary label-inline mr-2">Non PO-Product</span>
                                    <!--<table *ngIf="row.Posting_Status == '6'" style="font-size: 12px;" class="PayoutTable">
                          <tr>
                              <th>Status</th>
                              <th>UTR No</th>
                              <th>Transfer Date</th>
                          </tr>
                          
                          <tr>
                              <td><span class="label label-success label-inline mr-2">Paid/PayoutTransfered</span></td>
                              <td>{{row.UTR_No}}</td>
                              <td>{{row.UTR_Update_Date}}</td>
                               
                               
                          </tr>
                    </table>-->

                                </td>


                                <td>{{ row.Add_Stamp }}</td>
                                <td>
                                    {{ row.Booking_Date }}


                                    <span *ngIf="row.SR_Type == 'Normal'"
                                        class="label label-warning label-inline mr-2">Normal</span>
                                    <span *ngIf="row.SR_Type == 'Endorsement'"
                                        class="label label-default label-inline mr-2">Endorsement</span>
                                    <span *ngIf="row.SR_Type == 'Short'"
                                        class="label label-primary label-inline mr-2">Short</span>
                                    <span *ngIf="row.SR_Type == 'Recovery'"
                                        class="label label-danger label-inline mr-2">Recovery</span>
                                    <span *ngIf="row.SR_Type == 'Extra-Payout'"
                                        class="label label-danger label-inline mr-2">Extra Reward</span>

                                    <div style="margin-top:4px;">
                                        <span *ngIf="row.SR_Status == 'Complete'"
                                            class="label label-success label-inline mr-2">Booked</span>
                                        <span *ngIf="row.SR_Status == 'Pending'"
                                            class="label label-danger label-inline mr-2">UnBooked</span>
                                        <span *ngIf="row.SR_Status == 'Cancelled'"
                                            class="label label-danger label-inline mr-2">Cancelled</span>
                                        <span *ngIf="row.SR_Status == 'Recovery'"
                                            class="label label-danger label-inline mr-2">Recovery</span>
                                    </div>
                                </td>
                                <td>
                                    <span>{{ row.CurrentSrUserName }}</span>
                                    <!--<span class="label label-info label-inline mr-2">{{ row.SR_Current_Status }}</span>-->
                                </td>

                                <td>{{ row.SRCreateUser }}</td>
                                <td>{{ row.SR_Remark }}</td>


                                <td>{{ row.Source }}</td>
                                <td>{{ row.SR_No }}</td>
                                <td>{{ row.LOB_Name }}</td>

                                <td>{{ row.Payment_Towards }}</td>
                                <td>{{ row.Mode_Of_Payment }}</td>
                                <td>{{ row.Registration_No }}</td>
                                <td>{{ row.Estimated_Gross_Premium }}</td>

                                <td>{{ row.File_Type }}</td>
                                <td>{{ row.Customer_Name }}</td>


                                <td>{{ row.Agent_Name }}</td>
                                <td>{{ row.RM_Name }}</td>

                                <td><span *ngIf="row.UW_Name">{{ row.UW_Name }}</span></td>
                                <td><span *ngIf="row.Operation_Name">{{ row.Operation_Name }}</span></td>
                                <td><span *ngIf="row.Account_Name">{{ row.Account_Name }}</span></td>


                            </tr>
                        </tbody>
                        <tbody *ngIf="dataAr?.length == 0">
                            <tr>
                                <td colspan="15" align="center">No data available !</td>
                            </tr>
                        <tbody>
                    </table>
                </div>

                <!--end: Datatable-->

            </div>
            <!-- /.box-body -->
        </div>
        <!-- /.box -->
    </section>
    <!-- /.content -->

</div>